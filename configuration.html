---
layout: default
---

<div id="home">
    <h1>
        {% for header in site.headers %}
        <a class="header" href="{{ header.url }}">{{ header.name }}</a>
        {% endfor %}
    </h1>
    <p/>

    <h2>pgagroal.conf</h2>

    <h3>[pgagroal]</h3>

    Main configuration of pgagroal.
    <p/>
    
    <table border="1">
      <thead>
        <th align="left">Property</th>
        <th align="left">Default</th>
        <th align="left">Unit</th>
        <th align="left">Required</th>
        <th align="left">Description</th>
      </thead>
      <tbody>
        <tr>
          <td>host</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The bind address for pgagroal</td>
        </tr>
        <tr>
          <td>port</td>
          <td></td>
          <td>Int</td>
          <td>Yes</td>
          <td>The bind port for pgagroal</td>
        </tr>
        <tr>
          <td>unix_socket_dir</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The Unix Domain Socket location</td>
        </tr>
        <tr>
          <td>metrics</td>
          <td>0</td>
          <td>Int</td>
          <td>No</td>
          <td>The metrics port (disable = 0)</td>
        </tr>
        <tr>
          <td>management</td>
          <td>0</td>
          <td>Int</td>
          <td>No</td>
          <td>The remote management port (disable = 0)</td>
        </tr>
        <tr>
          <td>log_type</td>
          <td>console</td>
          <td>String</td>
          <td>No</td>
          <td>The logging type (console, file, syslog)</td>
        </tr>
        <tr>
          <td>log_level</td>
          <td>info</td>
          <td>String</td>
          <td>No</td>
          <td>The logging level (fatal, error, warn, info, debug1, ..., debug5)</td>
        </tr>
        <tr>
          <td>log_path</td>
          <td>pgagroal.log</td>
          <td>String</td>
          <td>No</td>
          <td>The log file location</td>
        </tr>
        <tr>
          <td>log_mode</td>
          <td>append</td>
          <td>String</td>
          <td>No</td>
          <td>Append to or create the log file (append, create)</td>
        </tr>
        <tr>
          <td>blocking_timeout</td>
          <td>30</td>
          <td>Int</td>
          <td>No</td>
          <td>The number of seconds the process will be blocking for a connection (disable = 0)</td>
        </tr>
        <tr>
          <td>idle_timeout</td>
          <td>0</td>
          <td>Int</td>
          <td>No</td>
          <td>The number of seconds a connection is been kept alive (disable = 0)</td>
        </tr>
        <tr>
          <td>validation</td>
          <td>off</td>
          <td>String</td>
          <td>No</td>
          <td>Should connection validation be performed. Valid options: off, foreground and background</td>
        </tr>
        <tr>
          <td>background_interval</td>
          <td>300</td>
          <td>Int</td>
          <td>No</td>
          <td>The interval between background validation scans in seconds</td>
        </tr>
        <tr>
          <td>max_retries</td>
          <td>5</td>
          <td>Int</td>
          <td>No</td>
          <td>The maximum number of iterations to obtain a connection</td>
        </tr>
        <tr>
          <td>max_connections</td>
          <td>100</td>
          <td>Int</td>
          <td>No</td>
          <td>The maximum number of connections to PostgreSQL (max 10000)</td>
        </tr>
        <tr>
          <td>allow_unknown_users</td>
          <td>true</td>
          <td>Bool</td>
          <td>No</td>
          <td>Allow unknown users to connect</td>
        </tr>
        <tr>
          <td>authentication_timeout</td>
          <td>5</td>
          <td>Int</td>
          <td>No</td>
          <td>The number of seconds the process will wait for valid credentials</td>
        </tr>
        <tr>
          <td>pipeline</td>
          <td>auto</td>
          <td>String</td>
          <td>No</td>
          <td>The pipeline type (auto, performance, session, transaction)</td>
        </tr>
        <tr>
          <td>auth_query</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Enable authentication query</td>
        </tr>
        <tr>
          <td>failover</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Enable failover support</td>
        </tr>
        <tr>
          <td>failover_script</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>The failover script to execute</td>
        </tr>
        <tr>
          <td>tls</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Enable Transport Layer Security (TLS)</td>
        </tr>
        <tr>
          <td>tls_cert_file</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Certificate file for TLS. This file must be owned by either the user running pgagroal or root</td>
        </tr>
        <tr>
          <td>tls_key_file</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Private key file for TLS. This file must be owned by either the user running pgagroal or root.
            Additionally permissions must be at least 0640 when owned by root or 0600 otherwise.</td>
        </tr>
        <tr>
          <td>tls_ca_file</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Certificate Authority (CA) file for TLS. This file must be owned by either the user running pgagroal or root</td>
        </tr>
        <tr>
          <td>libev</td>
          <td>auto</td>
          <td>String</td>
          <td>No</td>
          <td>Select the <a href="http://software.schmorp.de/pkg/libev.html">libev</a> backend to use. Valid options: auto, select, poll, epoll, iouring, devpoll and port</td>
        </tr>
        <tr>
          <td>buffer_size</td>
          <td>65535</td>
          <td>Int</td>
          <td>No</td>
          <td>The network buffer size (SO_RCVBUF and SO_SNDBUF)</td>
        </tr>
        <tr>
          <td>keep_alive</td>
          <td>on</td>
          <td>Bool</td>
          <td>No</td>
          <td>Have SO_KEEPALIVE on sockets</td>
        </tr>
        <tr>
          <td>nodelay</td>
          <td>on</td>
          <td>Bool</td>
          <td>No</td>
          <td>Have TCP_NODELAY on sockets</td>
        </tr>
        <tr>
          <td>non_blocking</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Have O_NONBLOCK on sockets</td>
        </tr>
        <tr>
          <td>backlog</td>
          <td>max_connections / 4</td>
          <td>Int</td>
          <td>No</td>
          <td>The backlog for listen(). Minimum 16</td>
        </tr>
        <tr>
          <td>hugepage</td>
          <td>try</td>
          <td>String</td>
          <td>No</td>
          <td>Huge page support (off, try, on)</td>
        </tr>
        <tr>
          <td>tracker</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Track connection lifecycle</td>
        </tr>
        <tr>
          <td>track_prepared_statements</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Track prepared statements (transaction pooling)</td>
        </tr>
        <tr>
          <td>pidfile</td>
          <td></td>
          <td>String</td>
          <td>No</td>
          <td>Path to the PID file</td>
        </tr>
      </tbody>
    </table>

    <p/>
    <b>Danger zone</b><br/>
    <table border="1">
      <thead>
        <th align="left">Property</th>
        <th align="left">Default</th>
        <th align="left">Unit</th>
        <th align="left">Required</th>
        <th align="left">Description</th>
      </thead>
      <tbody>
        <tr>
          <td>disconnect_client</td>
          <td>0</td>
          <td>Int</td>
          <td>No</td>
          <td>
            Disconnect clients that have been idle for more than the specified seconds.
            This setting <b>DOES NOT</b> take long running transactions into account
          </td>
        </tr>
        <tr>
          <td>disconnect_client_force</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>
            Disconnect clients that have been active for more than the specified seconds.
            This setting <b>DOES NOT</b> take long running transactions into account
          </td>
        </tr>
      </tbody>
    </table>
      
    <h3>Server section</h3>

    Specifies the PostgreSQL instances.
    <p/>

    <table border="1">
      <thead>
        <th align="left">Property</th>
        <th align="left">Default</th>
        <th align="left">Unit</th>
        <th align="left">Required</th>
        <th align="left">Description</th>
      </thead>
      <tbody>
        <tr>
          <td>host</td>
          <td></td>
          <td>String</td>
          <td>Yes</td>
          <td>The address of the PostgreSQL instance</td>
        </tr>
        <tr>
          <td>port</td>
          <td></td>
          <td>Int</td>
          <td>Yes</td>
          <td>The port of the PostgreSQL instance</td>
        </tr>
        <tr>
          <td>primary</td>
          <td></td>
          <td>Bool</td>
          <td>No</td>
          <td>Identify the instance as primary (hint)</td>
        </tr>
        <tr>
          <td>tls</td>
          <td>off</td>
          <td>Bool</td>
          <td>No</td>
          <td>Enable Transport Layer Security (TLS) support (Experimental - no pooling)</td>
        </tr>
      </tbody>
    </table>

    Note, that if host starts with a / it represents a path and pgagroal will connect using a Unix Domain Socket.
    <p/>
    The configuration is loaded from either the path specified by the -c flag or /etc/pgagroal/pgagroal.conf.

    <h3>Example</h3>

    <pre>
[pgagroal]
host = *
port = 2345

log_type = file
log_level = info
log_path = /tmp/pgagroal.log

max_connections = 100
idle_timeout = 600
validation = off
unix_socket_dir = /tmp/

[primary]
host = localhost
port = 5432
    </pre>
    
    <h2>pgagroal_hba.conf</h2>

    Specifies the host based authentication configuration of pgagroal.
    <p/>
    
    <table border="1">
      <thead>
        <th align="left">Column</th>
        <th align="left">Required</th>
        <th align="left">Description</th>
      </thead>
      <tbody>
        <tr>
          <td>TYPE</td>
          <td>Yes</td>
          <td>Specifies the access method for clients. host and hostssl are supported</td>
        </tr>
        <tr>
          <td>DATABASE</td>
          <td>Yes</td>
          <td>Specifies the database for the rule. Either specific name or all for all databases</td>
        </tr>
        <tr>
          <td>USER</td>
          <td>Yes</td>
          <td>Specifies the user for the rule. Either specific name or all for all users</td>
        </tr>
        <tr>
          <td>ADDRESS</td>
          <td>Yes</td>
          <td>Specifies the network for the rule. all for all networks, or IPv4 address with a mask (0.0.0.0/0) or IPv6 address with a mask (::0/0)</td>
        </tr>
        <tr>
          <td>METHOD</td>
          <td>Yes</td>
          <td>Specifies the authentication mode for the user. all for all methods, otherwise trust, reject, password, md5 or scram-sha-256</td>
        </tr>
      </tbody>
    </table>

    <p/>
    The configuration is loaded from either the path specified by the -a flag or /etc/pgagroal/pgagroal_hba.conf.

    <h3>Example</h3>
    
    <pre>
#
# TYPE  DATABASE USER  ADDRESS  METHOD
#
host    all      all   all      all
    </pre>

    Remote management users needs to have their database set to admin in order for the entry to be considered.

    <h2>pgagroal_databases.conf</h2>

    Specifies the limits for a database or a user or both. The limits are the number
    of connections from pgagroal to PostgreSQL for each entry.
    <p/>
    
    The file also defines the initial and minimum pool size for a database and user pair. Note, that this feature requires
    a user definition file, see below.
    <p/>
    
    <table border="1">
      <thead>
        <th align="left">Column</th>
        <th align="left">Required</th>
        <th align="left">Description</th>
      </thead>
      <tbody>
        <tr>
          <td>DATABASE</td>
          <td>Yes</td>
          <td>Specifies the database for the rule</td>
        </tr>
        <tr>
          <td>USER</td>
          <td>Yes</td>
          <td>Specifies the user for the rule</td>
        </tr>
        <tr>
          <td>MAX_SIZE</td>
          <td>Yes</td>
          <td>Specifies the maximum pool size for the entry. all for max_connections</td>
        </tr>
        <tr>
          <td>INITIAL_SIZE</td>
          <td>No</td>
          <td>Specifies the initial pool size for the entry. all for MAX_SIZE connections. Default is 0</td>
        </tr>
        <tr>
          <td>MIN_SIZE</td>
          <td>No</td>
          <td>Specifies the minimum pool size for the entry. all for MAX_SIZE connections. Default is 0</td>
        </tr>
      </tbody>
    </table>

    <p/>
    The configuration is loaded from either the path specified by the -l flag or /etc/pgagroal/pgagroal_databases.conf.

    <h3>Example</h3>
    
    <pre>
#
# DATABASE USER    MAX_SIZE INITIAL_SIZE MIN_SIZE
#
mydb       myuser  all
    </pre>
    
    <h2>pgagroal_users.conf</h2>

    The pgagroal_users configuration defines the users known to the system. This file is created and managed through
    the pgagroal-admin tool.
    <p/>
    The configuration is loaded from either the path specified by the -u flag or /etc/pgagroal/pgagroal_users.conf.

    <h2>pgagroal_frontend_users configuration</h2>

    The pgagroal_frontend_users configuration defines the passwords for the users connecting to pgagroal.
    This allows the setup to use different passwords for the pgagroal to PostgreSQL authentication.
    This file is created and managed through the pgagroal-admin tool.
    <p/>
    All users defined in the frontend authentication must be defined in the user vault (-u).
    <p/>
    Frontend users (-F) requires a user vault (-u) to be defined.
    <p/>
    The configuration is loaded from either the path specified by the -F flag or /etc/pgagroal/pgagroal_frontend_users.conf.

    <h2>pgagroal_admins.conf</h2>

    The pgagroal_admins configuration defines the administrators known to the system. This file is created and managed through
    the pgagroal-admin tool.
    <p/>
    The configuration is loaded from either the path specified by the -A flag or /etc/pgagroal/pgagroal_admins.conf.
    <p/>

    If pgagroal has both Transport Layer Security (TLS) and "management" enabled then pgagroal-cli can
    connect with TLS using the files ~/.pgagroal/pgagroal.key (must be 0600 permission),
    ~/.pgagroal/pgagroal.crt and ~/.pgagroal/root.crt.

    <h2>pgagroal_superuser.conf</h2>

    The pgagroal_superuser configuration defines the superuser known to the system. This file is created and managed through
    the pgagroal-admin tool. It may only have one user defined.
    <p/>
    The configuration is loaded from either the path specified by the -S flag or /etc/pgagroal/pgagroal_superuser.conf.

</div>
